--constrains ограничения полей со стороны бд--
create table Person(
    id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY ,
    name varchar NOT NULL ,
    age int check ( age > 0 ),
    email varchar UNIQUE
)

--one to many--
create table Director(
    director_id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY ,
    name varchar(100),
    age int CHECK ( age > 10 )
);
create table Movie(
    movie_id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY ,
    director_id int NOT NULL REFERENCES Director(director_id),
    name varchar(200) NOT NULL ,
    year_of_production int CHECK ( year_of_production > 1900 )
);
select Director.name,Movie.name from director join Movie on Director.director_id = Movie.director_id;

--one to one--
create table Citizen(
    citizen_id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY ,
    name varchar(100) NOT NULL ,
    age int CHECK ( age > 0 )
);
create table Passport(
    citizen_id int PRIMARY KEY REFERENCES Citizen(citizen_id),
    passport_number int NOT NULL UNIQUE
);
select name,passport_number from Citizen join Passport on Citizen.citizen_id=Passport.citizen_id;

--many to many--
create table Actor(
    actor_id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY ,
    name varchar(100) NOT NULL UNIQUE ,
    age int CHECK ( age > 0 )
);
create table Actor_Movie(
    actor_id int REFERENCES Actor(actor_id),
    movie_id int REFERENCES Movie(movie_id),
    PRIMARY KEY (actor_id,movie_id)
);
select Actor.name,Movie.name from Actor JOIN Actor_Movie on
Actor.actor_id = Actor_Movie.actor_id JOIN Movie on
Actor_Movie.movie_id=movie.movie_id;

--удаление связанных данных с ключом,по умолчанию выдает ошибку ON DELETE RESTRICT--
create table "Order"(
    order_id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY ,
    user_id int REFERENCES person(id) ON DELETE CASCADE
)

--не удаляет,во внешний ключ вставляет null--
create table "Order"(
    order_id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY ,
    user_id int REFERENCES person(id) ON SET NULL
)